global k = 5

global values
global occurs

probe syscall.*.return {
    if (execname() == "stap" || execname() == "stapio" || execname() == "builddb.py")
        next;

    values[execname(),occurs[execname()]] = name
    occurs[execname()]++

    if (occurs[execname()] == k) {
        printf("%s", execname())

        for (i=0; i < k; i++) {
            printf(" %s", values[execname(),i])
            values[execname(),i] = values[execname(),i+1]
        }

        printf("\n");
        occurs[execname()]--
    }
}
